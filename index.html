<!DOCTYPE html>
<html lang="my">
<head>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a237e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="á€¡á€€á€¼á€®á€¸á€€á€±á€¬á€„á€º">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>á€¡á€€á€¼á€®á€¸á€€á€±á€¬á€„á€º á€€á€¬á€¸á€‚á€­á€á€º - A Gyi Kaung Express</title>
    <style>
        :root { --primary: #1a237e; --secondary: #2e7d32; --accent: #fbc02d; --bg: #f8f9fa; }
        body { font-family: sans-serif; background-color: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; }
        .container { max-width: 600px; width: 100%; background: white; min-height: 100vh; box-shadow: 0 0 20px rgba(0,0,0,0.05); padding-bottom: 80px; margin: 0 auto; position: relative; }
        
        header { background: linear-gradient(135deg, var(--primary), #3949ab); color: white; padding: 30px 20px; text-align: center; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; }
        
        /* Bus List Grid Layout - á€•á€¼á€„á€ºá€†á€„á€ºá€‘á€¬á€¸á€á€±á€¬á€”á€±á€›á€¬ */
        #bus-list { 
            display: grid; 
            grid-template-columns: 1fr 1fr; /* á€€á€±á€¬á€ºá€œá€¶ á‚ á€á€¯ á€á€½á€²á€á€¼á€„á€ºá€¸ */
            gap: 12px; 
            padding: 15px; 
        }

        .bus-item { 
            background: white; 
            border: 1px solid #eee; 
            border-radius: 12px; 
            padding: 15px; 
            text-align: center;
            cursor: pointer; 
            transition: 0.3s; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100px;
        }
        .bus-item:hover { border-color: var(--primary); transform: translateY(-2px); }
        .bus-name { color: var(--primary); font-weight: bold; font-size: 15px; margin-bottom: 5px; }
        .bus-info { font-size: 12px; color: #666; }

        /* Floating Staff Button - á€¡á€±á€¬á€€á€ºá€á€¼á€±á€›á€¾á€­ á€œá€°á€•á€¯á€¶ Logo á€á€œá€¯á€á€º */
        .staff-fab {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 60px;
            height: 60px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            text-decoration: none;
            z-index: 1000;
            font-size: 24px;
        }

        /* Bus Layout */
        .bus-container { background-color: #263238; padding: 25px 15px; border-radius: 45px 45px 15px 15px; border: 6px solid #1a1a1a; margin: 20px auto; width: auto; max-width: 320px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .seat { background-color: #ffffff; border: 2px solid #3498db; padding: 12px 0; text-align: center; border-radius: 10px; font-weight: bold; font-size: 14px; cursor: pointer; }
        .seat.sold { background-color: #f44336; border-color: #b71c1c; color: white; cursor: not-allowed; }
        
        @keyframes shake { 0% {transform: rotate(0)} 25% {transform: rotate(3deg)} 50% {transform: rotate(-3deg)} 100% {transform: rotate(0)} }
        .seat.selected { background-color: var(--accent); border-color: #f57f17; animation: shake 0.3s infinite; }

        .last-row { grid-column: span 3; display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 5px; }

        /* Contact Buttons */
        .contact-group { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 0 20px; margin-top: 15px; }
        .btn { display: flex; align-items: center; justify-content: center; padding: 12px; border-radius: 12px; color: white; text-decoration: none; font-weight: bold; font-size: 13px; text-align: center; }
        .btn-call { background-color: #2e7d32; } 
        .btn-fb { background-color: #1877f2; } 
        .btn-viber { background-color: #7360f2; } 
        .btn-tele { background-color: #0088cc; }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<div class="container">
    <header>
        <h1 style="margin:0; font-size: 24px;">á€¡á€€á€¼á€®á€¸á€€á€±á€¬á€„á€º á€€á€¬á€¸á€‚á€­á€á€º</h1>
        <p style="margin:10px 0 0; opacity: 0.9;">á€™á€²á€‡á€¬ á€™á€¾ á€™á€”á€¹á€á€œá€±á€¸ á€á€›á€®á€¸á€…á€‰á€º</p>
    </header>

    <div id="home-view">
        <div style="text-align: center; padding: 20px;">
           <img src="myphoto.jpg" alt="á€€á€¬á€¸á€•á€¯á€¶" style="width: 100%; max-width: 500px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
           <p style="margin-top: 20px; font-weight: bold; color: var(--primary);">á€œá€€á€ºá€›á€¾á€­á€‘á€½á€€á€ºá€á€½á€¬á€™á€Šá€·á€º á€€á€¬á€¸á€œá€­á€¯á€„á€ºá€¸á€™á€»á€¬á€¸</p>
        </div>
        
        <div id="bus-list"></div>

        <h3 style="text-align: center; margin-top: 30px; font-size: 16px;">á€†á€€á€ºá€á€½á€šá€ºá€›á€”á€º</h3>
        <div class="contact-group">
            <a href="tel:+959777963991" class="btn btn-call">ğŸ“ Call</a>
            <a href="https://m.me/ko.phyo.227755" class="btn btn-fb">ğŸ’¬ Messanger</a>
            <a href="viber://add?number=959777963991" class="btn btn-viber">ğŸ’œ Viber</a>
            <a href="https://t.me/heinmezat" class="btn btn-tele">âœˆï¸ Telegram</a>
        </div>
    </div>

    <div id="booking-view" style="display: none; padding: 20px;">
        <button onclick="location.reload()" style="padding: 10px 20px; border-radius: 20px; border: none; background: #eee; cursor: pointer; margin-bottom: 20px; font-weight: bold;">â† á€•á€¼á€”á€ºá€‘á€½á€€á€ºá€™á€Šá€º</button>
        <h3 id="sel-bus-title" style="text-align: center; color: var(--primary);"></h3>
        <div id="seat-map" class="bus-container"></div>
        <p style="text-align: center; font-size: 12px; color: #757575; background: #fffde7; padding: 10px; border-radius: 10px;">(á€á€¯á€¶á€”á€¶á€•á€«á€á€ºá€€á€­á€¯á€”á€¾á€­á€•á€ºá á€¡á€›á€±á€¬á€„á€ºá€•á€¼á€±á€¬á€„á€ºá€¸á€•á€¼á€®á€¸ Screenshot á€›á€­á€¯á€€á€ºá€•á€­á€¯á€·á€•á€±á€¸á€•á€«)</p>
    </div>

    <a href="admin.html" class="staff-fab" title="Staff Login">
        ğŸ‘¤
    </a>
</div>

<script>
    // á€á€„á€ºá Firebase Config á€€á€­á€¯ á€’á€®á€™á€¾á€¬ á€•á€¼á€”á€ºá€‘á€Šá€·á€ºá€•á€«
    const firebaseConfig = {
        apiKey: "AIzaSyCOMmiWvHADYvb4ILURBeRo7YDh-Z1sknw",
        authDomain: "a-gyi-kaung.firebaseapp.com",
        databaseURL: "https://a-gyi-kaung-default-rtdb.firebaseio.com",
        projectId: "a-gyi-kaung",
        storageBucket: "a-gyi-kaung.firebasestorage.app",
        messagingSenderId: "1002724874482",
        appId: "1:1002724874482:web:7b08378f45b237cc3f986b"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    db.ref('trips').on('value', snap => {
        const data = snap.val();
        let html = '';
        for(let id in data) {
            html += `
            <div class="bus-item" onclick="showBus('${id}', '${data[id].name}')">
                <div class="bus-name">ğŸšŒ ${data[id].name}</div>
                <div class="bus-info">
                    ğŸ“… ${data[id].date}<br>
                    â° ${data[id].time}
                </div>
            </div>`;
        }
        document.getElementById('bus-list').innerHTML = html || '<p style="grid-column: span 2; text-align:center;">á€á€›á€®á€¸á€…á€‰á€ºá€™á€›á€¾á€­á€á€±á€¸á€•á€«á‹</p>';
    });

    function showBus(id, name) {
        document.getElementById('home-view').style.display = 'none';
        document.getElementById('booking-view').style.display = 'block';
        document.getElementById('sel-bus-title').innerText = "ğŸšŒ " + name;
        // á€¡á€±á€¬á€€á€ºá€á€¼á€±á€á€œá€¯á€á€ºá€€á€­á€¯ á€á€á€–á€»á€±á€¬á€€á€ºá€‘á€¬á€¸á€á€»á€„á€ºá€›á€„á€º
        document.querySelector('.staff-fab').style.display = 'none';
        
        db.ref('bookings/' + id).on('value', snap => {
            const booked = snap.val() || {};
            const map = document.getElementById('seat-map');
            map.innerHTML = '';
            
            const layout = [['A1','A2','D'],['B1','B2','B3'],['C1','C2','C3'],['D1','D2','D3'],['E1','E2','E3','E4']];
            
            layout.forEach((row, idx) => {
                const target = (idx === 4) ? document.createElement('div') : map;
                if(idx === 4) target.className = 'last-row';
                
                row.forEach(s => {
                    const div = document.createElement('div');
                    div.className = s === 'D' ? 'seat' : `seat ${booked[s] ? 'sold' : ''}`;
                    div.innerText = s === 'D' ? 'Driver' : (booked[s] ? "Sold" : s);
                    
                    if(s !== 'D' && !booked[s]) {
                        div.onclick = () => div.classList.toggle('selected');
                    }
                    target.appendChild(div);
                });
                if(idx === 4) map.appendChild(target);
            });
        });
    }
</script>
</body>
</html>
